<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>MineWeb docs</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://mineweb.org'>Retour sur mineweb.org</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation powered by Slate</a></li>
          <li style="position: absolute;bottom: 10px;font-size: 0.85em;"><a href="#" onClick="activeRightExample(this)">Passer le code à droite de l'écran</a></li>
          <script type="text/javascript">
            function activeRightExample (e) {
              var link = document.createElement('link')
              link.setAttribute('rel', 'stylesheet')
              link.setAttribute('type', 'text/css')
              link.setAttribute('id', 'examples-right')
              link.setAttribute('href', 'stylesheets/examples-right.css')
              document.getElementsByTagName('head')[0].appendChild(link)

              e.setAttribute('onClick', 'desactiveRightExample(this)')
              e.innerHTML = "Remettre l'affichage par défaut"
            }
            function desactiveRightExample (e) {
              var link = document.getElementById('examples-right').remove()

              e.setAttribute('onClick', 'activeRightExample(this)')
              e.innerHTML = "Passer le code à droite de l'écran"
            }
          </script>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<h2 id="c-39-est-quoi-mineweb">C&#39;est quoi MineWeb ?</h2>

<p>MineWeb est un <strong>CMS</strong>. Un CMS est un système de gestion de contenu. Plus précisément il vous permet de vous créer rapidement et facilement un site complètement personnalisable. MineWeb est la version 2 de l&#39;ancien CMS <strong>LapisCraft</strong> de Eywek. Celui-ci n&#39;étant plus stable et mal développé (cf. raisons <a href="https://eywek.fr/lc-explications.pdf">ici</a>).</p>

<p>MineWeb est développé sous un framework PHP nommé <strong>CakePHP</strong> permettant un développement plus <strong>rapide</strong>, <strong>sécurisé</strong> et <strong>optimisé</strong>. Le projet a été lancé en 2015 en compagnie de <strong>Mac&rsquo;</strong> permettant de convenir entièrement à <strong>vos besoins</strong>.</p>

<h2 id="pr-requis">Pré-requis</h2>

<p>Pour installer le CMS MineWeb votre hébergeur <strong>doit</strong> avoir :</p>

<ul>
<li>  Version PHP supérieure ou égale à 5.6 et inférieure à 7.2</li>
<li>  PDO activé</li>
<li>  cURL activé</li>
<li>  Réécriture d&#39;URL</li>
<li>  .htaccess activés</li>
<li>  La librairie GD2</li>
<li>  La possibilité d&#39;ouvrir un zip</li>
<li>  La possibilité d&#39;ouvrir un site à distance</li>
<li>  OpenSSL</li>
</ul>

<p>Pour plus de simplicité vous pouvez télécharger le <strong>fichier de compatibilité</strong> <a href="https://docs.mineweb.org/files/compatibilite.zip">ici</a>. Vous avez juste à extraire cette archive sur votre FTP pour voir si votre hébergeur est compatible.</p>

          <h1 id="installation">Installation</h1>

<aside class="alert alert-info">
<h3>Informations</h3>
<p>Vous devez placer tout le contenu de l'archive téléchargée, sur votre hébergeur (les fichiers .DS_Store & \__MACOSX sont inutiles). Il faut ensuite appliquer les permissions 755 ou 775 sur tous les fichiers (pour permettre les mises à jour). Puis rendez-vous sur sur http://{votre site}/install</p>
</aside>

<h2 id="tape-1-configuration-de-la-base-de-donn-es">Étape 1 - Configuration de la base de données</h2>

<p>Vous devez avoir une page demandant vos identifiants de base de données, vous devez entrez ceux-ci et tester la connexion, puis il vous faudra cliquer sur un bouton qui installera la base de données automatiquement.</p>

<h2 id="tape-2-cr-ation-de-l-39-administrateur">Étape 2 - Création de l&#39;administrateur</h2>

<p>Voici la deuxième et dernière étape de l&#39;installation du CMS, vous allez créer votre compte administrateur qui vous permettra d&#39;accéder au panel admin du CMS. Vous avez juste à remplir les champs qui vous sont présentés et à soumettre vos informations en cliquant sur le bouton &ldquo;Suivant&rdquo;.</p>

<h2 id="installation-termin-e">Installation terminée</h2>

<p>Une fois l&#39;installation du CMS complétée vous pouvez passer à l&#39;utilisation du CMS en lui-même. Pour configurer votre CMS il vous faut vous connecter en cliquant sur le bouton en haut à gauche de la barre de navigation. Vous cliquez sur connexion puis entrez vos informations pour vous connecter. Vous cliquez ensuite sur Panel administrateur, vous serez redirigé et vous pourrez ensuite cliquer sur <em>Général</em> puis <em>Préférences générales</em>.</p>

<h2 id="aide-externe-et-probl-mes-fr-quents">Aide externe et problèmes fréquents</h2>

<h3 id="probl-me-chez-livehost">Problème chez livehost</h3>

<p>Il est possible que vous obteniez une erreur dans ce style là :</p>

<p><code class="prettyprint">Warning: include(Cake/bootstrap.php): failed to open stream: No such file or directory in</code></p>

<p>Pour résoudre ce problème, rendez-vous dans <em>app/webroot</em>, ouvrez le fichier <em>index.php</em> et allez à la ligne 64</p>

<p><code class="prettyprint">//define(&#39;CAKE_CORE_INCLUDE_PATH&#39;, ROOT . DS . &#39;lib&#39;);</code></p>

<p>Retirez les deux slashs</p>

<p><code class="prettyprint">define(&#39;CAKE_CORE_INCLUDE_PATH&#39;, ROOT . DS . &#39;lib&#39;);</code></p>

<p>Sauvegardez et rechargez la page.</p>

<h3 id="autres">Autres</h3>

<ul>
<li>Si vous avez besoin d&#39;aide, si vous rencontrez un problème non répertorié ici, vous pouvez nous contacter sur notre <a href="https://discordapp.com/invite/3QYdt8r">Discord</a>.</li>
</ul>

          <h1 id="lier-serveur-site">Lier serveur-site</h1>

<aside class="alert alert-warning">
  <h3>Compatibilité</h3>
  <p>Les plugins sont compatibles à partir de la version 1.8</p>
</aside>

<aside class="alert alert-info">
  <p><strong>Type de connexion</strong>:  <br>
  - Par défaut : <em>connexion à un serveur lié avec le <a href="https://github.com/MineWeb/ServerBridge/raw/master/mineweb_bridge-2.0.0.jar">plugin Bukkit/Spigot/Bungeecord</a>, permet l’utilisation de toutes les fonctionnalités du CMS (boutique, classement factions, vote…)</em> <br>
  - Par Rrcon : <em>connexion par rcon, permet l’utilisation de la boutique ainsi que le plugin vote sans avoir besoin du plugin, ideal pour lier le BungeeCord</em> <br>
  - Ping : <em>connexion à un serveur sans plugin, permet uniquement d’avoir le nombre de joueurs en ligne et le nombre de joueurs maximums (la <strong>boutique</strong> et le <strong>classement</strong> factions <strong>ne pourront pas être utilisés</strong> avec ce type de connexion) </em></p>
</aside>

<h2 id="configuration-pr-alable">Configuration préalable</h2>

<p>Rendez-vous sur la page de liaison site-serveur sur le panel admin de votre CMS.
Vous devez dans un premier temps configurer le temps d’exécution maximum (appelé aussi timeout), il est conseillé de mettre 1 (seconde).</p>

<p><img src="https://docs.mineweb.org/images/server_timeout.png" /></p>

<aside class="alert alert-info">
Vous avez à côté deux boutons pour désactiver la fonctionnalité (qui mettra automatiquement le statut du serveur à : éteint) si vous ne souhaitez pas utiliser la liaison site-serveur. Et un autre bouton pour activer/désactiver le cache sur la “bannière” (permet que le message affiché sur le site (joueurs connectés, MOTD…) soit stocké pendant quelques minutes permettant d’éviter la surcharge de commande au serveur).
</aside>

<h2 id="liaison-un-serveur-par-d-faut">Liaison à un serveur (par défaut)</h2>

<p>Maintenant nous allons lier votre <strong>serveur Minecraft</strong> au <strong>CMS</strong>. Pour cela vous devez avoir installé sur votre serveur le plugin MineWeb disponible à <a href="https://github.com/MineWeb/ServerBridge/raw/master/mineweb_bridge-2.0.0.jar">cette adresse</a>.
Une fois le plugin téléchargé, placez-le dans votre dossier <code class="prettyprint">plugins</code> de votre serveur et <strong>redémarrez celui-ci</strong>.
Vous n’avez <strong>pas à toucher à la configuration du plugin</strong>.</p>

<p>Maintenant que vous avez configuré le serveur vous pouvez <strong>ajouter un serveur</strong> et remplir les informations nécessaires :</p>

<ul>
<li><code class="prettyprint">Type de la connexion</code>, donc mettez <em>Par défaut</em>.</li>
<li><code class="prettyprint">Nom</code> par le nom affiché.</li>
<li><code class="prettyprint">IP</code> par l’ip (ou domaine) sans le port.</li>
<li><code class="prettyprint">Port</code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</li>
</ul>

<p>Cliquez ensuite sur <em>Connexion</em> pour tester la connexion, si celle-ci échoue, rendez-vous sur <a href="https://docs.mineweb.org/#la-connexion-choue">cette section</a></p>

<aside class="alert alert-info">
<b>Port customisé :</b> Vous pouvez également configurer un port personnalisé si vous ne souhaitez pas utiliser le port minecraft de votre serveur. Pour cela, assurez-vous d'avoir un port disponible et ouvert et effectuez la commande /mineweb port <port>.
</aside>

<aside class="alert alert-info">
<b>ProtocolLib :</b> Si vous avez ProtocolLib et que le plugin produit une erreur à cause du plugin de MineWeb vous pouvez utiliser <a href="https://github.com/MineWeb/ServerBridge/raw/no-injector/mineweb_bridge-2.0.0.jar">celui-ci</a>. Vous devez obligatoirement configurer un port disponible et ouvert à l'aide la commande /mineweb port <port>.
</aside>

<h2 id="liaison-par-rcon">Liaison par RCON</h2>

<p>Vous n’avez pas besoin de plugin pour cette liaison. Le protocol RCON est disponible sur tous les serveurs minecraft et permet de communiquer avec le site. Pour utiliser ce protocol il vous faut le configurer dans votre server.properties :
- Passer enable-rcon à true
- Changer rcon.password par un mot de passe
- Changer rcon.port par un port disponible
Il vous suffit ensuite de configurer un serveur comme ceci depuis la page de liaison :</p>

<ul>
<li><code class="prettyprint">Type</code> de la connexion, donc mettez <em>RCON</em>.</li>
<li><code class="prettyprint">Nom</code> par le nom affiché.</li>
<li><code class="prettyprint">IP</code> par l’ip (ou domaine) <strong>sans le port</strong>.</li>
<li><code class="prettyprint">Port</code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</li>
<li><code class="prettyprint">Port RCON</code> par le port de RCON configureé (doit être ouvert et disponible bien sûr).</li>
<li><code class="prettyprint">Mot de passe RCON</code> par le mot de passe RCON.</li>
</ul>

<p>Cliquez ensuite sur <em>Connexion</em> pour tester la connexion.</p>

<h2 id="liaison-par-ping">Liaison par PING</h2>

<p>Vous n’avez pas besoin de plugin pour cette liaison, il vous suffit juste de configurer un serveur comme ceci depuis la page de liaison :</p>

<ul>
<li><code class="prettyprint">Type</code> de la connexion, donc mettez <em>Ping</em>.</li>
<li><code class="prettyprint">Nom</code> par le nom affiché.</li>
<li><code class="prettyprint">IP</code> par l’ip (ou domaine) <strong>sans le port</strong>.</li>
<li><code class="prettyprint">Port</code> par le port de votre serveur (25565 par défaut si vous n’avez pas de port).</li>
</ul>

<p>Cliquez ensuite sur <em>Connexion</em> pour tester la connexion.</p>

<h2 id="la-connexion-choue">La connexion échoue</h2>

<p>Dans un premier temps, vérifiez que vous n&#39;avez pas d&rsquo;<strong>erreur dans la console</strong> de votre serveur en rapport avec le plugin MineWeb.</p>

<p>Ensuite, essayez de <strong>redémarrer votre serveur</strong>.</p>

<p>Si la connexion échoue toujours, venez-nous voir sur <a href="https://discordapp.com/invite/3QYdt8r">Discord</a> avec un maximum d&#39;explications et d&#39;informations, et répondez à ces questions :</p>

<ul>
<li>Quelle IP avez-vous mis ?</li>
<li>Quel port ?</li>
<li>Aucune erreur dans la console ?</li>
<li>Quelle version de Spigot avez-vous ?</li>
<li>Avez-vous essayé de rédemarrer le serveur ?</li>
<li>Fournissez-nous des logs de démarrage sur pastebin.com</li>
<li>Fournissez-nous le fichier config.json du plugin sur pastebin.com</li>
<li>Fournissez-nous le fichier mineweb.log du plugin sur pastebin.com</li>
</ul>

          <h1 id="cr-er-un-plugin">Créer un plugin</h1>

<h3 id="introduction">Introduction</h3>

<p>Un plugin (aussi appelé <em>extension</em>), est un ensemble de <strong>fichiers</strong> qui sont ajoutés à votre CMS pour y ajouter plusieurs <strong>fonctionnalités</strong> ou modifier certains <strong>comportements</strong> par défaut. Différents plugins “officiels” sont <em>déjà disponibles</em> <a href="https://github.com/MineWeb?utf8=%E2%9C%93&amp;q=Plugin-&amp;type=&amp;language=php">ici</a>. D’autres peuvent être <em>développés par la communauté</em> et c’est le but de ce tutoriel.</p>

<h2 id="cr-ation">Création</h2>

<h3 id="cr-ation-des-fichiers-dossiers">Création des fichiers/dossiers</h3>

<p>Dans un premier temps, il va falloir créer le dossier de votre plugin, ce dossier doit être créé dans le dossier <code class="prettyprint">app/Plugin/</code>. Le nom du dossier doit être le nom de votre plugin.</p>

<p>Par <strong>exemple</strong> si je veux créer un plugin de <strong>boutique</strong>, je vais l’appeler : <strong>Shop</strong>.</p>

<p>Une fois ce dossier créé, il faut créer différents autres dossiers et fichiers :</p>

<ul>
<li><code class="prettyprint">Config/</code></li>
<li><code class="prettyprint">Controller/</code></li>
<li><code class="prettyprint">Model/</code></li>
<li><code class="prettyprint">View/</code></li>
<li><code class="prettyprint">lang/</code></li>
<li><code class="prettyprint">SQL/</code></li>
</ul>

<p>C’est tout pour les dossiers, il nous reste maintenant encore des fichiers à créer tels que :</p>

<ul>
<li><code class="prettyprint">Config/bootstrap.php</code></li>
<li><code class="prettyprint">Config/routes.php</code></li>
<li><code class="prettyprint">config.json</code></li>
</ul>

<h3 id="explications-et-configuration">Explications et configuration</h3>

<p>Maintenant que vous avez créé tous ces fichiers, nous allons passer à la configuration de votre plugin. Pour cela, ouvrez le fichier <strong>config.json</strong>, c&#39;est dans ce fichier que toute la configuration sera située.</p>

<blockquote>
<p>Configuration par défaut (à remplir)</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"NAME"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"AUTHOR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.2.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Maintenant, vous allez pouvoir configurer. Remplacez <strong>NAME</strong> par le <em>nom de votre plugin</em> et puis <strong>AUTHOR</strong> par votre pseudo.
Ensuite voici une explication des autres lignes :</p>

<ul>
<li><code class="prettyprint">version</code> : la version de votre plugin (<strong>double</strong>),</li>
<li><code class="prettyprint">useEvents</code> : si votre plugin utilise les événements disponible sur le CMS (<strong>boolean</strong>),</li>
<li><code class="prettyprint">permissions</code> : les permissions de votre plugin (voir plus tard) (<strong>array</strong>)</li>
<li><code class="prettyprint">requirements</code> : les pré-requis de votre plugin : vous devez spécifier comme clé un autre ID de plugin (au format <em>auteur.slug</em>) ou CMS et comme valeur une version correcte (cf. le semantic versionning donc préfixée ou non par ^ / ~ / &gt;= / &lt;=). Si un des pré-requis n&#39;est pas rempli, le plugin ne sera pas installé sur le CMS.</li>
</ul>

<h3 id="les-liens-de-la-barre-de-navigation">Les liens de la barre de navigation</h3>

<p>Si votre plugin dispose d&#39;une route publique (pouvant être accessible pour n&#39;importe quel utilisateur) il peut être important de configurer lesquelles de ces routes peuvent être ajoutées sur la barre de navigation depuis le panel admin. Pour cela, il vous suffit d&#39;ajouter la clé <code class="prettyprint">navbar_routes</code> dans le fichier <code class="prettyprint">config.json</code>.
Cette clé doit contenir un objet avec comme clé le nom de la route et comme valeur la route.</p>

<blockquote>
<p>Exemple</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Boutique"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_menus"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"navbar_routes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"Boutique"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/shop"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"Eywek"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.2.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h3 id="les-menus-panel-admin">Les menus panel admin</h3>

<p>Vous pouvez, si vous le souhaitez, avoir un menu au niveau du panel admin avec des sous-liens (comme pour la boutique). Pour ceci, il vous suffit d&#39;ajouter la clé <code class="prettyprint">admin_menus</code> dans la configuration du plugin.
La clé sera le nom du menu, vous pouvez utilisez des noms déjà utilisés pour placer votre menu en tant que sous-menu d&#39;un déjà présent (comme sur l&#39;exemple). Vous pouvez alors ajouter un index pour être après tel ou tel sous-menu
Les clés du panel admin sont les suivantes</p>

<table><thead>
<tr>
<th>Valeur</th>
<th>Explication</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">Dashboard</code></td>
<td>Correspondant au menu &lsquo;Dashboard&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">GLOBAL__ADMIN_GENERAL</code></td>
<td>Correspondant au menu &#39;Général&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">GLOBAL__CUSTOMIZE</code></td>
<td>Correspondant au menu &#39;Personnalisation&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">SERVER__TITLE</code></td>
<td>Correspondant au menu &#39;Serveur&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">GLOBAL__ADMIN_OTHER_TITLE</code></td>
<td>Correspondant au menu &#39;Autres&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">STATS__TITLE</code></td>
<td>Correspondant au menu &#39;Statistiques&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">MAINTENANCE__TITLE</code></td>
<td>Correspondant au menu &#39;Maintenance&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">GLOBAL__UPDATE</code></td>
<td>Correspondant au menu &#39;Mise à jour&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">HELP__TITLE</code></td>
<td>Correspondant au menu &#39;Aide&rsquo; du panel admin</td>
</tr>
</tbody></table>

<p>La valeur doit ensuite être un objet contenu l&rsquo;<code class="prettyprint">icon</code>, la <code class="prettyprint">route</code> ou le <code class="prettyprint">menu</code> (et optionnelement <code class="prettyprint">permission</code> et <code class="prettyprint">index</code>)</p>

<blockquote>
<p>Associez-lui comme valeur un tableau avec vos sous-liens, comme ceci par exemple :</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"NAME"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_menus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"GLOBAL__CUSTOMIZE"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"Boutique"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"index"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shopping-cart"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"Gérer les articles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shopping-basket"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_ITEMS"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"Gérer les promotions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"percent"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_VOUCHERS"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/shop/vouchers"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"Gérer les paiements"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit-card"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_PAYMENT"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/payment"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"navbar_routes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"Boutique"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/shop"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"AUTHOR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.2.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"NAME"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_menus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"Boutique"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"index"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shopping-cart"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"Gérer les articles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shopping-basket"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_ITEMS"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"Gérer les promotions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"percent"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_VOUCHERS"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/shop/vouchers"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"Gérer les paiements"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit-card"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_PAYMENT"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/payment"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"navbar_routes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"Boutique"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/shop"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"AUTHOR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.2.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>La clé <code class="prettyprint">permission</code> dans chaque lien est optionnelle, elle permet d&#39;afficher le lien seulement si la permission est accordée au groupe de l&#39;utilisateur.</p>
</blockquote>

<h2 id="les-tables-sql">Les tables SQL</h2>

<p>Les tables dont vous avez besoin pour votre plugin vont être générées automatiquement par un shell.
Dans un premier temps, toutes les tables de votre plugin doivent être préfixées par le nom de votre plugin.
Par exemple, pour le plugin Shop les tables doivent être préfixés par <strong>shop__</strong>.</p>

<p>Pour générer vos tables automatiquement dans un schema (qui sera <strong>indispensable</strong> pour avoir un plugin valide) il vous faut vous rendre sur le SSH de votre serveur dédié/VPS/ordinateur pour pouvoir utiliser la console de CakePHP. Il vous faut ensuite vous rendre dans le dossier contenant les fichiers du CMS puis, il vous faudra taper
<code class="prettyprint">app/Console/cake schema generate plugin-shop</code>
Un fichier <em>schema.php</em> sera automatiquement créé dans le dossier SQL de votre plugin.</p>

<p>Si vous ne pouvez pas accéder à la console de CakePHP, vous pouvez toujours créer votre fichier <em>SQL/schema.php</em> <strong>manuellement</strong>.</p>

<blockquote>
<p>Vous devez commençer le fichier comme ceci</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">ShopAppSchema</span> <span class="k">extends</span> <span class="nx">CakeSchema</span> <span class="p">{</span>

    <span class="k">public</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">'schema.php'</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Il vous faut ensuite suivre la documentation <a href="http://book.cakephp.org/2.0/fr/console-and-shells/schema-management-and-migrations.html#ecrire-un-schema-cakephp-a-la-main">ici</a></p>
</blockquote>

<h2 id="callbacks">Callbacks</h2>

<p>Les <strong>callbacks</strong> sont des fonctions appelées automatiquement par le CMS lors de certaines actions.</p>

<p>Vous pouvez, si vous le souhaitez, créer un fichier <strong>MainComponent.php</strong> dans le dossier <code class="prettyprint">Controller/Component</code> de votre plugin.</p>

<blockquote>
<p>Dans ce fichier vous pouvez y ajouter :</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">MainComponent</span> <span class="k">extends</span> <span class="nx">Object</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onEnable</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onDisable</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Ces fonctions <strong>onEnable</strong> et <strong>onDisable</strong> seront <strong>automatiquement</strong> appelées par le CMS lors de l’<strong>installation</strong>, l’<strong>activation</strong> <em>(pour le onEnable)</em>, et pour la <strong>désinstallation</strong> et la <strong>désactivation</strong> <em>(pour le onDisable)</em> du plugin.</p>

<h2 id="utiliser-les-events">Utiliser les events</h2>

<p>Dans la config.json du plugin, passez <strong>useEvents</strong> à <strong>true</strong>.</p>

<p>Pour créer un <strong>écouteur</strong> <em>(Listener)</em>, il vous faut créer un fichier dans le dossier <em>/Event/</em> de votre plugin. Le fichier doit être appelé de la manière suivante <em>{PLUGIN_NAME}{NOM}EventListener.php</em> (préfixé par le slug de votre plugin).</p>

<blockquote>
<p>Exemple: ShopBuyEventListener
Et son contenu doit être comme ceci :</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
  <span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">'CakeEventListener'</span><span class="p">,</span> <span class="s1">'Event'</span><span class="p">);</span>

  <span class="k">class</span> <span class="err">{</span><span class="nc">PLUGIN_NAME</span><span class="p">}{</span><span class="nx">NOM</span><span class="p">}</span><span class="nx">EventListener</span> <span class="k">implements</span> <span class="nx">CakeEventListener</span> <span class="p">{</span>

    <span class="k">private</span> <span class="nv">$controller</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$controller</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">controller</span> <span class="o">=</span> <span class="nv">$controller</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">implementedEvents</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<blockquote>
<p>Pour écouter un event il vous faut l&#39;ajouter dans l&#39;array retourné par la fonction <strong>implementedEvents()</strong> avec votre fonction comme valeur. Et il vous faut ensuite créer votre fonction.
Exemple :</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
  <span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">'CakeEventListener'</span><span class="p">,</span> <span class="s1">'Event'</span><span class="p">);</span>

  <span class="k">class</span> <span class="nc">NAMEEventListener</span> <span class="k">implements</span> <span class="nx">CakeEventListener</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">implementedEvents</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
          <span class="s1">'requestPage'</span> <span class="o">=&gt;</span> <span class="s1">'mafonction'</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">mafonction</span><span class="p">(</span><span class="nv">$event</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>

<h3 id="liste-des-events-disponibles">Liste des events disponibles</h3>

<h3 id="global">Global</h3>

<ul>
<li><strong>requestPage</strong> : appelé lors de chaque requête sans données particulières.</li>
<li><strong>onPostRequest</strong> : appelé lors d’une requête POST sans données particulières.</li>
<li><strong>beforePageDisplay</strong> : appelé lors de chaque chargement de page dans le afterFilter sans données particulières.</li>
<li><strong>onLoadPage</strong> : appelé lors de chaque chargement de page dans le beforeRender sans données particulières.</li>
<li><strong>onLoadAdminPanel</strong> : appelé lors de chaque chargement de page admin (prefix) dans le beforeRender sans données particulières.</li>
</ul>

<h3 id="fonction-particuli-re">Fonction particulière</h3>

<ul>
<li><strong>beforeEncodePassword</strong> : appelé avant chaque encodage de mot de passe avec le pseudo et le mot de passe en données.</li>
<li><strong>beforeSendMail</strong> : appelé avant chaque envoi d’email avec le message et la configuration en données.</li>
<li><strong>beforeUploadImage</strong> : appelé avant chaque upload d’image avec la requête et le nom de l’image voulu en données.</li>
</ul>

<h3 id="news">News</h3>

<ul>
<li><strong>beforeAddComment</strong> : appelé avant que le commentaire ne soit enregistré avec le contenu, l’ID de la news et les infos de l’utilisateur en données.</li>
<li><strong>beforeLike</strong> : appelé avant que le like ne soit enregistré avec l’ID de la news et les infos de l’utilisateur en données.</li>
<li><strong>beforeDislike</strong> : appelé avant que le like ne soit supprimé avec l’ID de la news et les infos de l’utilisateur en données.</li>
<li><strong>beforeDeleteComment</strong> : appelé avant que le commentaire ne soit supprimé avec l’ID du commentaire, l’ID de la news et les infos de l’utilisateur en données.</li>
<li><strong>beforeDeleteNews</strong> : appelé avant que la news ne soit supprimé avec l’ID de la news et les infos de l’utilisateur en données.</li>
<li><strong>beforeAddNews</strong> : appelé avant que la news ne soit enregistré avec le contenu de la requête et les infos de l’utilisateur en données.</li>
<li><strong>beforeEditNews</strong> : appelé avant que la news ne soit enregistré avec le contenu de la requête, l’ID de la news et les infos de l’utilisateur en données.</li>
</ul>

<h3 id="user">User</h3>

<ul>
<li><strong>onLogin</strong> : appelé à chaque login avec l’utilisateur et register (boolean) comme données.</li>
<li><strong>beforeRegister</strong> : appelé avant l’enregistrement d’un utilisateur (après la validation) avec les données de la requête comme données.</li>
<li><strong>beforeConfirmAccount</strong> : appelé avant la confirmation en base de donnée de l’utilisateur avec l’ID de l’utilisateur et manual si confirmé par un administrateur comme données.</li>
<li><strong>beforeSendResetPassMail</strong> : appelé avant l’envoi de l’email permettant la réinitialisation du mot de passe avec l’ID de l’utilisateur et clé de reset comme données</li>
<li><strong>beforeResetPassword</strong> : appelé avant l’enregistrement du nouveau mot de passe avec l’ID de l’utilisateur et le nouveau mot de passe comme données.</li>
<li><strong>onLogout</strong> : appelé pendant la déconnexion avec la session “user” comme données.</li>
<li><strong>beforeUpdatePassword</strong> : appelé avant l’enregistrement du nouveau mot de passe avec l’utilisateur et le nouveau mot de passe encodé comme données.</li>
<li><strong>beforeUpdateEmail</strong> : appelé avant l’enregistrement du nouvel email avec l’utilisateur et le nouveau email comme données.</li>
<li><strong>beforeSendPoints</strong> : appelé avant l’enregistrement de la transaction avec l’utilisateur, le nouveau solde de l’utilisateur, à qui sont transféré les points et combien comme données.</li>
<li><strong>beforeEditUser</strong> : appelé avant que les données ne soit enregistrées avec l’ID de l’utilisateur, les données et <code class="prettyprint">password_updated</code> comme données.</li>
<li><strong>beforeDeleteUser</strong> : appelé avant que l’utilisateur ne soit supprimé avec ses informations comme données.</li>
</ul>

<h2 id="utiliser-les-modules">Utiliser les modules</h2>

<h3 id="c-39-est-quoi">C&#39;est quoi ?</h3>

<p>Les modules permettent aux développeurs de plugins d&#39;ajouter du <strong>code HTML</strong>, <strong>code PHP</strong>, etc&hellip; facilement depuis des <strong>pages du CMS</strong>.</p>

<h3 id="liste-des-modules">Liste des modules</h3>

<p>Les modules disponibles sont :</p>

<ul>
<li><code class="prettyprint">user_profile</code> <em>profil d&#39;utilisateur</em></li>
<li><code class="prettyprint">user_profile_messages</code> <em>profil d&#39;utilisateur (haut de page)</em></li>
<li><code class="prettyprint">admin_user_edit</code> <em>modification admin d&#39;un utilisateur (bas de page)</em></li>
<li><code class="prettyprint">admin_user_edit_form</code> <em>modification admin d&#39;un utilisateur (dans le formulaire)</em></li>
<li><code class="prettyprint">home</code> <em>accueil</em></li>
<li><code class="prettyprint">news</code> <em>page affichant une news</em></li>
</ul>

<h3 id="comment-les-utiliser">Comment les utiliser ?</h3>

<p>Pour utiliser un module dans votre <strong>plugin</strong>, il vous suffit de créer un dossier <em>/Modules/</em> dans le dossier de votre plugin. Il vous faut ensuite <strong>créer</strong> un fichier nommé par le <strong>nom du module</strong> que vous voulez utiliser et avec l&#39;extension <strong>.ctp</strong>.</p>

<p>Par exemple pour utiliser le module <em>user_profile</em> il vous faut créer le fichier <em>/Modules/user_profile.ctp</em>.</p>

<p>Dans ce fichier, vous pouvez ajouter le code que vous souhaitez, <strong>HTML</strong>, <strong>PHP</strong> ou encore <strong>JS</strong> ou <strong>CSS</strong>.</p>

<h2 id="exemple-d-39-un-plugin">Exemple d&#39;un plugin</h2>

<p>Je vais avec vous, développer un plugin vous présentant le développement sous Mineweb avec le framework Cakephp 2.x .</p>

<p>Arborescence du plugin :</p>

<ul>
<li><code class="prettyprint">app/Plugin/</code>

<ul>
<li><code class="prettyprint">Tutorial/</code>

<ul>
<li><code class="prettyprint">Config/</code>

<ul>
<li><code class="prettyprint">bootstrap.php</code></li>
<li><code class="prettyprint">routes.php</code></li>
</ul></li>
<li><code class="prettyprint">Controller/</code>

<ul>
<li><code class="prettyprint">TutorialAppController.php</code></li>
<li><code class="prettyprint">TutorialController</code></li>
</ul></li>
<li><code class="prettyprint">Model/</code>

<ul>
<li><code class="prettyprint">Info.php</code></li>
<li><code class="prettyprint">TutorialAppModel.php</code></li>
</ul></li>
<li><code class="prettyprint">SQL/</code>

<ul>
<li><code class="prettyprint">schema.php</code></li>
</ul></li>
<li><code class="prettyprint">View/</code>

<ul>
<li><code class="prettyprint">Tutorial/</code>

<ul>
<li><code class="prettyprint">admin_index.ctp</code></li>
<li><code class="prettyprint">index.ctp</code></li>
</ul></li>
</ul></li>
<li><code class="prettyprint">lang/</code>

<ul>
<li><code class="prettyprint">en_US.json</code></li>
<li><code class="prettyprint">fr_FR.json</code></li>
</ul></li>
<li><code class="prettyprint">config.json</code></li>
</ul></li>
</ul></li>
</ul>

<p>Dans un premier temps, nous allons créer les routes du plugin. Celles-ci permettent que nous puissions relier les divers arguments de l&#39;url aux controleurs.</p>

<p>Pour des raisons de conventions, vous aurez remarqué que nous ne fermons pas nos balises PHP avec ?&gt;. Cela évite de multiples problèmes et vous familiarise avec les frameworks PHP.  </p>

<p>Si vous voulez plus d&#39;information, je vous conseille ces liens : <a href="http://stackoverflow.com/questions/4410704/why-would-one-omit-the-close-tag/4499749#4499749">StackOverflow</a> ainsi que les recommandations <a href="http://www.php-fig.org/psr/psr-2/">PHP-Fig</a></p>

<h3 id="les-routes">Les routes</h3>

<p>Allons ensemble dans notre fichier <code class="prettyprint">Config/routes.php</code> et écrivons ceci :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nx">Router</span><span class="o">::</span><span class="na">connect</span><span class="p">(</span><span class="s1">'/tutorial'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'controller'</span> <span class="o">=&gt;</span> <span class="s1">'tutorial'</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'index'</span><span class="p">,</span> <span class="s1">'plugin'</span> <span class="o">=&gt;</span> <span class="s1">'tutorial'</span><span class="p">]);</span>

</code></pre>

<p>Notre plugin possède donc une route, lorsqu&#39;un utilisateur ira sur monsite.fr/tutorial, la route s&#39;occupera de rediriger notre visiteur dans le plugin tutorial, à notre controleur Tutorial puis à notre fonction index.</p>

<h3 id="les-contr-leurs">Les contrôleurs</h3>

<p>Ensuite, nous allons créer un contrôleur parent, celui-ci n&#39;est pas obligatoire pour développer un plugin, mais si l&#39;architecture de votre plugin fait que vous devez avoir plusieurs contrôleurs avec des fonctions communes aux deux, vous pourrez facilement joindre vos fonctions.</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialAppController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="c1">// Vos fonctions communes ici
</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">math</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$y</span><span class="p">,</span> <span class="nv">$z</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">(</span><span class="nv">$x</span><span class="o">*</span><span class="nv">$x</span><span class="p">)</span><span class="o">*</span><span class="nv">$y</span><span class="o">-</span><span class="nv">$z</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>

<p><br /></p>

<p>Voici donc notre contrôleur principal, je vous ai mis quelques exemples de code ainsi que des commentaires.</p>

<p><br /></p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialController</span> <span class="k">extends</span> <span class="nx">TutorialAppController</span><span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(){</span>

        <span class="c1">// Chargement du Model Tutorial
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">'Tutorial.Info'</span><span class="p">);</span>

        <span class="c1">//On enregistre dans $datas le contenu de toute la table tutorial
</span>        <span class="nv">$datas</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'all'</span><span class="p">);</span>

        <span class="c1">//On passe la variable à la vue afin de pouvoir la réutiliser dans index.ctp
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">'datas'</span><span class="p">));</span>

        <span class="c1">//Pour passer plusieurs variable à la vue :
</span>        <span class="c1">//$this-&gt;set(compact('datas', 'variable', 'infos'));
</span>
        <span class="c1">//Pour donner un titre à votre page : Dans le html &lt;title&gt; Titre &lt;title&gt;
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'title_for_layout'</span><span class="p">,</span> <span class="s1">'Titre'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<h3 id="les-mod-les">Les modèles</h3>

<p>Les modèles sont des fichiers qui permettent l&#39;interaction entre nos contrôleurs et notre base de données.</p>

<p>Dans notre fichier <code class="prettyprint">Model/TutorialAppModel.php</code> et écrivons ceci :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialAppModel</span> <span class="k">extends</span> <span class="nx">AppModel</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tablePrefix</span> <span class="o">=</span> <span class="s1">'tutorial__'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p><br /></p>

<p>Cela nous permet de définir un préfix à notre table. Tous les modèles du plugin l&#39;utiliseront. Il nous reste plus qu&#39;à créer notre modèle.</p>

<p>Pour cela, créez un fichier <code class="prettyprint">Model/Tutorial.php</code> et écrivez ceci :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Info</span> <span class="k">extends</span> <span class="nx">TutorialAppModel</span><span class="p">{</span>

<span class="p">}</span>
</code></pre>

<p><br /></p>

<p>Pour l&#39;instant, il est vide, oui, car j&#39;ai directement fait ma requête SQL depuis <code class="prettyprint">Controller/TutorialController.php</code>.</p>

<p>Mais nous aurions pu faire ceci :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialController</span> <span class="k">extends</span> <span class="nx">TutorialAppController</span><span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">'Tutorial.Info'</span><span class="p">);</span>

        <span class="c1">//Appel de la fonction présent dans notre modèle.
</span>        <span class="nv">$datas</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">'datas'</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><br /></p>

<p>Ainsi que dans depuis <code class="prettyprint">Model/Tutorial.php</code>.</p>

<p><br /></p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Info</span> <span class="k">extends</span> <span class="nx">TutorialAppModel</span><span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">(){</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'all'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<h3 id="les-sch-mas-migrations">Les schémas / migrations</h3>

<p>Les schémas / migrations selon les frameworks sont-ce qui permet à l&#39;application de créer des bases de données, les supprimer afin qu&#39;une base de données soit créer à l&#39;exécution.</p>

<p>Voici celui utilisé pour le tutoriel :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialAppSchema</span> <span class="k">extends</span> <span class="nx">CakeSchema</span> <span class="p">{</span>

    <span class="k">public</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">'schema.php'</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{}</span>

    <span class="k">public</span> <span class="nv">$tutorial__infos</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'integer'</span><span class="p">,</span> <span class="s1">'null'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">'default'</span> <span class="o">=&gt;</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">'length'</span> <span class="o">=&gt;</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">'unsigned'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'primary'</span><span class="p">],</span>
        <span class="s1">'pseudo'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'string'</span><span class="p">,</span> <span class="s1">'null'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">'default'</span> <span class="o">=&gt;</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">'length'</span> <span class="o">=&gt;</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">'unsigned'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">],</span>
        <span class="s1">'date'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'datetime'</span><span class="p">,</span> <span class="s1">'null'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">'default'</span> <span class="o">=&gt;</span> <span class="kc">null</span><span class="p">]</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre>

<p><br /></p>

<p>Je vous conseille de toujours avoir un champ ID dans votre base de données, cela vous évitera des problèmes futures dans la conception de votre plugin.</p>

<h3 id="les-vues">Les vues</h3>

<p>Pour finir, il nous reste la vue, c&#39;est là où l&#39;on met notre code html.</p>

<p>Grâce a notre variable $datas transmise, nous pouvons la récupérer afin de l&#39;afficher sous forme de tableau.</p>

<p><br /></p>
<pre class="highlight php"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-12"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;section&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"text-page"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;thead&gt;</span>
                                <span class="nt">&lt;th&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__ID'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/th&gt;</span>
                                <span class="nt">&lt;th&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__PSEUDO'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/th&gt;</span>
                                <span class="nt">&lt;th&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__DATE'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/th&gt;</span>
                            <span class="nt">&lt;/thead&gt;</span>
                            <span class="nt">&lt;tbody&gt;</span>
                                <span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$datas</span> <span class="k">as</span> <span class="nv">$data</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span>
                                    <span class="nt">&lt;tr&gt;</span>
                                        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'id'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="nt">&lt;/td&gt;</span>
                                        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'pseudo'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="nt">&lt;/td&gt;</span>
                                        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'date'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="nt">&lt;/td&gt;</span>
                                    <span class="nt">&lt;/tr&gt;</span>
                               <span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span>
                            <span class="nt">&lt;/tbody&gt;</span>
                        <span class="nt">&lt;/table&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/section&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>

<p><br /></p>

<p>Le fichier admin_index.ctp est la page d&#39;accueil de notre plugin sur la panel d&#39;administration. Je ne vous explique pas car il s&#39;agit de html basique avec une boucle pour afficher les données.</p>

<p>Juste le data-ajax=&ldquo;true&quot;pour envoyer notre formulaire en ajax</p>

<p><br /></p>
<pre class="highlight php"><code><span class="nt">&lt;section</span> <span class="na">class=</span><span class="s">"content"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-12"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-header with-border"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"box-title"</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__ADD'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="nt">&lt;/h3&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-body"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-12"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">""</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">data-ajax=</span><span class="s">"true"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
                                    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"pseudo"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Pseudo"</span> <span class="nt">/&gt;</span>
                                <span class="nt">&lt;/div&gt;</span>
                                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
                                    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-primary center-block"</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__SUBMIT'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/button&gt;</span>
                                <span class="nt">&lt;/div&gt;</span>
                            <span class="nt">&lt;/form&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-body"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-12"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-responsive dataTable"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;thead&gt;</span>
                                <span class="nt">&lt;tr&gt;</span>
                                    <span class="nt">&lt;th&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__PSEUDO'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="nt">&lt;/th&gt;</span>
                                    <span class="nt">&lt;th&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'TUTORIAL__DATE'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="nt">&lt;/th&gt;</span>
                                    <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
                                <span class="nt">&lt;/tr&gt;</span>
                                <span class="nt">&lt;/thead&gt;</span>
                                <span class="nt">&lt;tbody&gt;</span>
                                    <span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$datas</span> <span class="k">as</span> <span class="nv">$data</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span>
                                        <span class="nt">&lt;tr&gt;</span>
                                            <span class="nt">&lt;td&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'pseudo'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="nt">&lt;/td&gt;</span>
                                            <span class="nt">&lt;td&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Time</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'date'</span><span class="p">],</span> <span class="s1">'%H:%M, %e %B %Y'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/td&gt;</span>
                                            <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">onclick=</span><span class="s">"confirmDel('/admin/tutorial/tutorial/delete/</span><span class="cp">&lt;?=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">][</span><span class="s1">'id'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="s">')"</span> <span class="na">class=</span><span class="s">"btn btn-danger"</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__DELETE'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
                                        <span class="nt">&lt;/tr&gt;</span>
                                    <span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span>
                                <span class="nt">&lt;/tbody&gt;</span>
                            <span class="nt">&lt;/table&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/section&gt;</span>
</code></pre>

<p><br /></p>

<p>Une fois fait cela, il faut donc dans notre contrôleur principal, mettre le code pour notre parti admin. Voici le rendu final :</p>

<p><br /></p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">TutorialController</span> <span class="k">extends</span> <span class="nx">TutorialAppController</span><span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(){</span>

        <span class="c1">// Chargement du Model Tutorial
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">'Tutorial.Info'</span><span class="p">);</span>

        <span class="c1">//On enregistre dans $datas le contenu de toute la table tutorial
</span>        <span class="nv">$datas</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'all'</span><span class="p">);</span>

        <span class="c1">//On passe la variable à la vue afin de pouvoir la réutiliser dans index.ctp
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">'datas'</span><span class="p">));</span>

        <span class="c1">//Pour passer plusieurs variable à la vue :
</span>        <span class="c1">//$this-&gt;set(compact('datas', 'variable', 'infos'));
</span>
        <span class="c1">//Pour donner un titre à votre page : Dans le html &lt;title&gt; Titre &lt;title&gt;
</span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'title_for_layout'</span><span class="p">,</span> <span class="s1">'Titre'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">admin_index</span><span class="p">(){</span>
        <span class="c1">//Important pour permettre seulements aux admins du site d'y avoir accès.
</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isConnected</span> <span class="nx">AND</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">User</span><span class="o">-&gt;</span><span class="na">isAdmin</span><span class="p">()){</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">'Tutorial.Info'</span><span class="p">);</span>

            <span class="c1">//Si la requete est de type ajax
</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">'ajax'</span><span class="p">)){</span>
                <span class="c1">//Vu que c'est en ajax, nous n'avons pas besoin du layout
</span>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autoRender</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

                <span class="c1">//Je récupère le champs name="pseudo"
</span>                <span class="nv">$pseudo</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">'pseudo'</span><span class="p">];</span>
                <span class="nv">$date</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">);</span>

                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$pseudo</span><span class="p">,</span> <span class="nv">$date</span><span class="p">);</span>

                <span class="c1">//Envoi réponse en ajax
</span>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'statut'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">'msg'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__SUCCESS'</span><span class="p">))));</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="c1">//Je déclare le thème du panel admin
</span>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">layout</span> <span class="o">=</span> <span class="s1">'admin'</span><span class="p">;</span>

                <span class="c1">//Je récupère les données de ma base.
</span>                <span class="nv">$datas</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>

                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">'datas'</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
            <span class="c1">//Sinon on redirige notre visiteur indiscret vers la page d'accueil
</span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">admin_delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isConnected</span> <span class="nx">AND</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">User</span><span class="o">-&gt;</span><span class="na">isAdmin</span><span class="p">()){</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autoRender</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">'Tutorial.Info'</span><span class="p">);</span>

            <span class="c1">//J'utilise _delete() car delete() existe déjà avec cakephp
</span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Info</span><span class="o">-&gt;</span><span class="na">_delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>

            <span class="c1">//Redirection vers notre page
</span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'/admin/tutorial'</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><br /></p>

<p>Et notre model final :</p>

<p><br /></p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Info</span> <span class="k">extends</span> <span class="nx">TutorialAppModel</span><span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">(){</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'all'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">_delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">){</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="nv">$pseudo</span><span class="p">,</span> <span class="nv">$date</span><span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">([</span><span class="s1">'pseudo'</span> <span class="o">=&gt;</span> <span class="nv">$pseudo</span><span class="p">,</span> <span class="s1">'date'</span> <span class="o">=&gt;</span> <span class="nv">$date</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<h3 id="les-fichiers-de-langues">Les fichiers de langues</h3>

<p>Vous aurez pu remarquer <code class="prettyprint">$Lang-&gt;get()</code>, en effet mes textes sont rangés dans un fichier de traduction, voici sa structure :</p>

<p><code class="prettyprint">lang/fr_FR.json</code></p>

<p><br /></p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"TUTORIAL__ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ID"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TUTORIAL__PSEUDO"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pseudo"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TUTORIAL__DATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><br /></p>

<p><code class="prettyprint">lang/en_US.json</code></p>

<p><br /></p>
<pre class="highlight json"><code><span class="p">{}</span><span class="w">
</span></code></pre>

<p><br /></p>

<p>Si vous ne mettez pas deux accolades dedans, votre plugin ne fonctionnera pas correctement.</p>

<p>Notez que vous n&#39;êtes pas obligé d&#39;utiliser les fichiers de traductions, même si vous ne mettez rien dedans, veillez à les créer et à écrire ceci dedans : <code class="prettyprint">{}</code></p>

<h3 id="t-l-chargement">Téléchargement</h3>

<p>Je vous laisse télécharger le plugin afin de récupérer les codes : <a href="files/Tutorial.zip">lien du plugin</a></p>

<p>Il vous suffit d&#39;extraire le .zip et de le mettre dans /app/Plugin. Vous allez ensuite dans placer le contenu extrait dans app/Plugin. Et allez sur la page de gestion des plugins,  si cela ne marche pas , videz votre cache : /app/tmp/</p>

<h2 id="utilisation-avanc">Utilisation avancé</h2>

<p>Dans le dossier <code class="prettyprint">Config/</code> se trouve un fichier nommé <code class="prettyprint">bootstrap.php</code>, je vous redirige vers ce lien <a href="https://book.cakephp.org/2.0/fr/development/configuration.html#bootstrapping-cakephp">Documentation CakePHP</a> pour savoir à quoi sert t-il.</p>

<h3 id="int-ragir-avec-le-serveur">Intéragir avec le serveur</h3>

<p>Vous pouvez très bien envoyer des commandes ou récupérer toutes sortes d&#39;informations grâce au plugin de Bridge du CMS.
Pour cela il vous suffit de procéder comme ceci (dans vos controllers) :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="c1">// Pour récupérer la liste des connectés sur le serveur sélectionné
</span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">([[</span><span class="s1">'GET_PLAYER_LIST'</span> <span class="o">=&gt;</span> <span class="p">[]]],</span> <span class="nv">$server_id</span><span class="p">);</span>
<span class="c1">// Vous pouvez également procéder comme ceci :
</span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">([</span><span class="s1">'GET_PLAYER_LIST'</span> <span class="o">=&gt;</span> <span class="p">[]],</span> <span class="nv">$server_id</span><span class="p">);</span>
<span class="c1">// Ou plus simplement
</span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s1">'GET_PLAYER_LIST'</span><span class="p">,</span> <span class="nv">$server_id</span><span class="p">);</span>

<span class="cm">/*
  Vous pouvez également stack les méthodes
*/</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">([</span><span class="s1">'GET_PLAYER_LIST'</span> <span class="o">=&gt;</span> <span class="p">[],</span> <span class="s1">'GET_PLAYER_COUNT'</span> <span class="o">=&gt;</span> <span class="p">[]],</span> <span class="nv">$server_id</span><span class="p">);</span>
</code></pre>

<p>Pour savoir si <strong>un joueur est connecté</strong> vous pouvez utilisez cette méthode :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">userIsConnected</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$server_id</span><span class="p">);</span>
</code></pre>

<p>Pour <strong>envoyer des commandes</strong> vous avez ces deux méthodes :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">send_command</span><span class="p">(</span><span class="s1">'say Boujour'</span><span class="p">,</span> <span class="nv">$server_id</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">commands</span><span class="p">([</span><span class="s1">'say Boujour'</span><span class="p">,</span> <span class="s1">'say Boujour 2'</span><span class="p">],</span> <span class="nv">$server_id</span><span class="p">);</span>
</code></pre>

<p>Pour envoyer des <strong>commandes différéees</strong> pous avez cette méthode :</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Server</span><span class="o">-&gt;</span><span class="na">scheduleCommands</span><span class="p">([</span><span class="s1">'say Boujour'</span><span class="p">,</span> <span class="s1">'say Boujour 2'</span><span class="p">],</span> <span class="nv">$time</span><span class="p">,</span> <span class="p">[</span><span class="nv">$server_id</span><span class="p">]);</span> <span class="c1">// Le $time doit être en minute
</span></code></pre>

<p>Voici la <strong>liste des méthodes disponibles</strong> :</p>

<ul>
<li>GET_PLAYER_LIST</li>
<li>GET_PLAYER_COUNT</li>
<li>IS_CONNECTED</li>
<li>GET_PLUGIN_TYPE</li>
<li>GET_SYSTEM_STATS</li>
<li>RUN_COMMAND</li>
<li>RUN_SCHEDULED_COMMAND</li>
<li>GET_SERVER_TIMESTAMP</li>
<li>GET_BANNED_PLAYERS</li>
<li>GET_MAX_PLAYERS</li>
<li>GET_MOTD</li>
<li>GET_VERSION</li>
<li>GET_WHITELISTED_PLAYERS</li>
</ul>

<h3 id="rajouter-des-m-thodes">Rajouter des méthodes</h3>

<p>Vous pouvez créer un plugin Java vous permettant d&#39;ajouter des méthodes au plugin de Bridge pour pouvoir récupérer plus de données pour vos plugins. Pour cela il vous suffit de créer un plugin minecraft normal puis il vous faut ajouter MinewebBridge comme dépendance dans votre plugin.yml et d&#39;appeler cette méthode dans votre plugin pour ajouter une méthode :</p>
<pre class="highlight java"><code><span class="n">BukkitCore</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getMethods</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="s">"GET_FACTIONS"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GetFactions</span><span class="o">());</span>
</code></pre>

<p>La class que vous passez en paramètre doit ressembler a ceci :</p>
<pre class="highlight java"><code><span class="nd">@MethodHandler</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GetFactions</span> <span class="kd">implements</span> <span class="n">IMethod</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="n">execute</span><span class="o">(</span><span class="n">ICore</span> <span class="n">instance</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">inputs</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>

<aside class="alert alert-info">
  <b>Note:</b> Vous pouvez vous aider du plugin de classement Factions disponible <a href="https://github.com/MineWeb/MineWebFactions">ici</a>.
</aside>

          <h1 id="cr-er-des-th-mes">Créer des thèmes</h1>

<h2 id="introduction">Introduction</h2>

<p>Un thème, c’est des fichiers qui sont ajoutés à votre CMS pour transformer l&#39;apparence de celui-ci. Différents thèmes “officiels” sont déjà disponibles <a href="https://github.com/MineWeb?utf8=%E2%9C%93&amp;q=Theme-&amp;type=&amp;language=">ici</a>. D’autres peuvent être développés par la communauté et c’est le but de ce tutoriel.</p>

<p>Il faut savoir que les thèmes sont une couche supplémentaire, c&#39;est-à-dire que si votre thème ne s&#39;occupe pas d&#39;une page du site, c&#39;est le thème par défaut qui prendra la relève.</p>

<aside class="alert alert-info">Il est important et même presque indispensable d'avoir des connaissances en HTML/CSS voire JS et PHP pour pouvoir faire son propre thème.</aside>

<h2 id="cr-ation-des-dossiers-amp-fichiers">Création des dossiers &amp; fichiers</h2>

<p>Dans un premier temps, il va falloir créer le dossier de votre thème, ce dossier doit être créé dans le dossier <code class="prettyprint">app/View/Themed/</code>. Le nom du dossier doit être le nom de votre thème. Par exemple si je veux créer un thème de démonstration, je vais l’appeler : Demo (évitez les accents, les espaces et les tirets, essayez d&#39;utiliser des mots anglais pour le nom du dossier).</p>

<p>Une fois ce dossier créé, il faut créer différents autres dossiers et fichiers :</p>

<ul>
<li><code class="prettyprint">Config/</code></li>
<li><code class="prettyprint">Layouts/</code></li>
<li><code class="prettyprint">webroot/</code>

<ul>
<li><code class="prettyprint">css/</code></li>
<li><code class="prettyprint">js/</code></li>
<li><code class="prettyprint">img/</code></li>
</ul></li>
</ul>

<p>C’est tout pour les dossiers, il nous reste maintenant encore des fichiers à créer tels que :</p>

<ul>
<li><code class="prettyprint">Config/config.json</code></li>
</ul>

<h2 id="utilisation-de-la-configuration">Utilisation de la configuration</h2>

<p>Pour que votre thème soit valide, celui-ci doit contenir un fichier <em>config.json</em> dans le dossier <em>Config/</em> du thème. Ce fichier doit contenir des informations bien précises au format JSON.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slider"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"supported"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Vous allez devoir configurer les informations les plus importantes.
Tout d&#39;abord le <em>name</em> qui est le nom de votre thème, vous pouvez à cet endroit écrire le nom de votre thème en français, avec des accents, espaces ou autre si vous le souhaitez. Ce nom sera affiché sur le panel admin du CMS. (exemple : Démonstration).</p>

<p>Après, il faut configurer le <em>slug</em>, il faut ici insérer le nom du dossier du thème précédemment choisi (exemple : Demo).</p>

<p>Pour la colonne <em>author</em>, mettez ici votre pseudo.</p>

<p>Pour la <em>version</em> du thème, la version doit être au format X.Y.Z comme expliqué <a href="http://semver.org">ici</a>.</p>

<p>Pour <em>slider</em>, mettez <strong>true</strong> ou <strong>false</strong> selon si vous souhaitez ou non utiliser le système de slider prévu par le CMS <em>(cette clé permet d&#39;afficher ou non le menu slider dans le panel admin)</em>.</p>

<p>Ne vous occupez pas non plus de <em>configurations</em> et <em>supported</em>, nous verrons cela plus tard.</p>

<h2 id="modifier-la-disposition-globale-du-site">Modifier la disposition globale du site</h2>

<p>Nous allons dans cette étape voir comment modifier la disposition du site, tous les éléments qui seront affichés sur chaque page (head, footer&hellip;).
Pour modifier ceci, il vous faut créer un fichier <em>default.ctp</em> dans le dossier <em>Layouts</em>.</p>

<aside class="alert alert-info">A savoir que les fichiers de vue (modification de la structure HTML) ont tous comme extension **.ctp** et non **.html** ou **.php** mais vous pouvez quand même y insérer de l'HTML ou du PHP.</aside>

<p>Pour le contenu du fichier <em>default.ctp</em> vous pouvez prendre exemple sur les thèmes déjà existants ou sur le thème par défaut (le fichier <em>default.ctp</em> se trouverait alors dans <em>/app/View/Layouts/default.ctp</em>).</p>

<p>Dans ce fichier, on repère plusieurs grandes parties:</p>

<ul>
<li>L&#39;entête</li>
<li>La barre de navigation</li>
<li>Le contenu</li>
<li>Le footer</li>
<li>Les scripts</li>
</ul>

<h3 id="l-39-ent-te">L&#39;entête</h3>

<p>Elle constitue les données nécessaires au chargement de la page. L&#39;entête doit contenir tous les liens vers les fichiers CSS de votre thème, le titre de la page, ainsi que diverses méta-données. Le tout doit être englobé dans une balise <code class="prettyprint">&lt;head&gt;</code></p>

<p>Pour inclure vos fichiers CSS et JS, utilisez les fonctions suivantes:</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">css</span><span class="p">(</span><span class="s1">'NomDuDossierDuTheme.votrefichier.css'</span><span class="p">);</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'NomDuDossierDuTheme.votrefichier.js'</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Bien entendu, les fichiers CSS et JS nécessaires doivent être ajoutés dans les dossiers correspondants du <code class="prettyprint">webroot</code>.</p>

<p>Variables utiles:
 - <code class="prettyprint">$website_name</code> - le nom du site défini dans la configuration du CMS
 - <code class="prettyprint">$title_for_layout</code> - le nom de la page actuelle</p>

<h3 id="la-barre-de-navigation">La barre de navigation</h3>

<p>La barre de navigation est une partie délicate des thèmes. Elle doit être générée par la configuration du CMS, et demande certaines connaissances en PHP pour être bien comprise.
Si vous n&#39;êtes pas un adepte du PHP, vous pouvez essayer d&#39;utiliser le code déjà présent de certains thèmes pour l&#39;adapter au votre.</p>

<table><thead>
<tr>
<th>Fonction ou variable</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">$this-&gt;Html-&gt;url(&#39;/&#39;)</code></td>
<td>Donne l&#39;URL de l&#39;accueil du site</td>
</tr>
<tr>
<td><code class="prettyprint">$Lang-&gt;get(&#39;GLOBAL__HOME&#39;)</code></td>
<td>Retourne le mot &lsquo;Accueil&rsquo; (ou sa traduction)</td>
</tr>
<tr>
<td><code class="prettyprint">$isConnected</code></td>
<td>Vrai si l&#39;utilisateur est connecté.</td>
</tr>
<tr>
<td><code class="prettyprint">$this-&gt;Html-&gt;url(array(&#39;controller&#39; =&gt; &#39;profile&#39;, &#39;action&#39; =&gt; &#39;index&#39;, &#39;plugin&#39; =&gt; false))</code></td>
<td>Donne l&#39;URL de la page de profil</td>
</tr>
<tr>
<td><code class="prettyprint">$Permissions-&gt;can(&#39;ACCESS_DASHBOARD&#39;); ?&gt;</code></td>
<td>Vrai si l&#39;utilisateur peut accéder au panel d&#39;administration. Vous pouvez, de cette manière, vérifier toutes les permissions possibles d&#39;un utilisateur.</td>
</tr>
<tr>
<td><code class="prettyprint">$this-&gt;Html-&gt;url(array(&#39;controller&#39; =&gt; &#39;admin&#39;, &#39;action&#39; =&gt; &#39;index&#39;, &#39;plugin&#39; =&gt; false, &#39;admin&#39; =&gt; true))</code></td>
<td>Donne l&#39;URL du panel d&#39;administration.</td>
</tr>
<tr>
<td><code class="prettyprint">$this-&gt;Html-&gt;url(array(&#39;controller&#39; =&gt; &#39;user&#39;, &#39;action&#39; =&gt; &#39;logout&#39;, &#39;plugin&#39; =&gt; false))</code></td>
<td>Donne l&#39;URL permettant de se déconnecter.</td>
</tr>
</tbody></table>

<p>La génération se fait à partir du code suivant (exemple):</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nav</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$nav</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'submenu'</span><span class="p">]))</span><span class="o">:</span> <span class="cp">?&gt;</span>
            <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">here</span> <span class="o">==</span> <span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'url'</span><span class="p">])</span> <span class="p">{</span> <span class="cp">?&gt;</span><span class="s"> active</span><span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">&lt;?=</span> <span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'url'</span><span class="p">]</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="cp">?&gt;</span><span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">else</span><span class="o">:</span> <span class="cp">?&gt;</span>
            <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"dropdown"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">class=</span><span class="s">"dropdown-toggle"</span> <span class="na">data-toggle=</span><span class="s">"dropdown"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-expanded=</span><span class="s">"false"</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="cp">?&gt;</span> <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"caret"</span><span class="nt">&gt;&lt;/span&gt;&lt;/a&gt;</span>
                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"dropdown-menu"</span> <span class="na">role=</span><span class="s">"menu"</span><span class="nt">&gt;</span>
                <span class="cp">&lt;?php</span>
                <span class="nv">$submenu</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'submenu'</span><span class="p">]);</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$submenu</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                <span class="cp">?&gt;</span>
                    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">&lt;?=</span> <span class="nb">rawurldecode</span><span class="p">(</span><span class="nb">rawurldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$value</span><span class="p">[</span><span class="s1">'Navbar'</span><span class="p">][</span><span class="s1">'open_new_tab'</span><span class="p">])</span> <span class="o">?</span> <span class="s1">' target="_blank"'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span><span class="cp">&lt;?=</span> <span class="nb">rawurldecode</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="s1">'+'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="nv">$k</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                <span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
                <span class="nt">&lt;/ul&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>
    <span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Il est conseillé de prendre pour exemple un thème déjà existant afin de comprendre les différentes variables et fonctions utilisées habituellement.</p>

<h3 id="le-contenu">Le contenu</h3>

<p>Votre layout doit contenir un emplacement qui accueillera le contenu des pages.
Pour récupérer tout le contenu qui doit être affiché, utilisez la fonction suivante:</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="s1">'content'</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>

<aside class="alert alert-warning">Votre thème doit gérer la mise en page des plugins. Vous devez admettre que les plugins ne proposent aucune mise en page particulière au départ (vous pourrez modifier chaque plugin individuellement).</aside>

<p>Aidez-vous de la classe <code class="prettyprint">container</code> ou <code class="prettyprint">container-fluid</code> de Bootstrap afin d&#39;organiser le contenu sur la page.</p>
<pre class="highlight php"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="s1">'content'</span><span class="p">);</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>

<aside class="alert alert-info">Vous pouvez tester votre mise en page avec le plugin Banlist ou FactionRanking.</aside>

<h3 id="les-scripts">Les scripts</h3>

<p>Les scripts sont généralement chargés en fin de page.
Pour charger un script JS depuis votre thème, utilisez la fonction suivante:</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'NomDuDossierDuTheme.votrefichier.js'</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Certaines parties de code contenues dans le <em>default.ctp</em> doivent être conservées, comme par exemple ceci en fin de page :</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'app.js'</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'form.js'</span><span class="p">)</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="err">
// Config FORM/APP.JS

var LIKE_URL = "</span><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'controller'</span> <span class="o">=&gt;</span> <span class="s1">'news'</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'like'</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="err">";
var DISLIKE_URL = "</span><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'controller'</span> <span class="o">=&gt;</span> <span class="s1">'news'</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'dislike'</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="err">";

var LOADING_MSG = "</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__LOADING'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="err">";
var ERROR_MSG = "</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__ERROR'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="err">";
var INTERNAL_ERROR_MSG = "</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ERROR__INTERNAL_ERROR'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="err">";
var FORBIDDEN_ERROR_MSG = "</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ERROR__FORBIDDEN'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="err">"
var SUCCESS_MSG = "</span><span class="cp">&lt;?=</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'GLOBAL__SUCCESS'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="err">";

var CSRF_TOKEN = "</span><span class="cp">&lt;?=</span> <span class="nv">$csrfToken</span> <span class="cp">?&gt;</span><span class="err">"</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$google_analytics</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$google_analytics</span><span class="p">))</span> <span class="p">{</span> <span class="cp">?&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="err">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', '</span><span class="cp">&lt;?=</span> <span class="nv">$google_analytics</span> <span class="cp">?&gt;</span><span class="s1">', '</span><span class="nx">auto</span><span class="s1">');
    ga('</span><span class="nx">send</span><span class="s1">', '</span><span class="nx">pageview</span><span class="err">'</span><span class="p">);</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?=</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$configuration_end_code</span><span class="p">))</span> <span class="o">?</span> <span class="nv">$configuration_end_code</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span>
</code></pre>

<blockquote>
<p>Vous pouvez trouver plus d&#39;informations sur la <a href="http://book.cakephp.org/2.0/fr/views.html">documentation officiel de CakePHP</a> (<a href="https://fr.wikipedia.org/wiki/Framework">Framework</a> PHP utilisé pour MineWeb).</p>
</blockquote>

<p>Ce code permet de faire fonctionner correctement MineWeb notamment les formulaires en AJAX ou d&#39;afficher les paramètres configurées sur le panel admin.</p>

<h2 id="les-l-ments">Les éléments</h2>

<p>Le dossier <code class="prettyprint">Elements</code> sert à charger différentes parties de votre thème quand vous en avez besoin, à la manière de modules que vous pouvez ajouter.
Par exemple, on peut y créer un fichier <code class="prettyprint">navbar.ctp</code>, et y ajouter tout le code de notre barre de navigation.
Pour ajouter la barre de navigation, il suffit d&#39;utiliser le code suivant sur n&#39;importe quelle page (dans notre cas, dans le fichier de layout <code class="prettyprint">default.ctp</code>):</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">element</span><span class="p">(</span><span class="s1">'navbar'</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Le code de la barre de navigation sera alors inséré à l&#39;endroit choisi.</p>

<p>Il est recommandé de séparer les parties où le code est assez imposant (par exemple, la barre de navigation). Cela vous permettra d&#39;isoler au mieux les différents bugs que vous pouvez rencontrer, d&#39;éviter une fausse manipulation sur l&#39;ensemble du code, et surtout d&#39;avoir un espace de travail plus aéré. On peut par exemple créer un élément pour le slider, le footer, la sidebar, etc.
Vous pouvez aussi, de cette manière, remplacer certains éléments chargés par le CMS ou différents plugins (comme le modal de connexion/inscription).</p>

<h2 id="modifier-les-diff-rentes-pages">Modifier les différentes pages</h2>

<p>Pour modifier les différentes pages du CMS il vous faudra créer un dossier avec le nom du Controller et un fichier <em>.ctp</em> avec le nom de l&#39;action. Si vous ne comprenez pas ou que vous ne pouvez pas vous embêter, prenez exemple sur des thèmes déjà fait (<em>app/View/Themed</em> si vous en avez téléchargé depuis votre panel admin) ou sur le thème de base (<em>app/View/</em>).</p>

<p>Par exemple, pour modifier la page affichée quand vous lisez une news/un article, il vous faudra créer un fichier <strong>News/index.ctp</strong> et y insérer le contenu que vous souhaitez selon le modèle du thème par défaut (pour utiliser les bonnes variables).</p>

<aside class="alert alert-info">Tout comme pour le <em>layout.ctp</em> vous pouvez vous référer à la <a href="http://book.cakephp.org/2.0/fr/views.html">documentation officielle de CakePHP</a>.</aside>

<h2 id="modifier-les-diff-rentes-pages-d-39-un-plugin">Modifier les différentes pages d&#39;un plugin</h2>

<p>Pour modifier les pages d&#39;un plugin il vous faudra tout comme à l&#39;étape précédente créer un dossier avec le nom du Controller et un fichier avec le nom de l&#39;action, <strong>sauf que</strong> il vous faudra placer ce dossier dans un autre dossier appelé <em>Plugin</em>.</p>

<aside class="alert alert-info">Pour créer vos fichiers/dossiers, référez-vous aux plugins en eux-mêmes, situés dans <em>app/Plugin/</em>, leurs fichiers <em>.ctp</em> seront dans le dossier <em>View</em>.</aside>

<p>Il est mieux aussi de <strong>préciser dans la configuration</strong> si vous <em>supporter</em> (stylisé) des plugins. Pour cela, revenons dans le fichier <em>Config/config.json</em> et nous allons toucher à <em>supported</em>. En effet, vous aller devoir écrire l&rsquo;<em>ID</em> du plugin et la ou les versions supportées. Par exemple :</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"supported"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"eywek.shop"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Vous pouvez voir que l&rsquo;<em>ID</em> du plugin est spécial, en effet celui-ci se compose de la manière suivante : <strong>auteur.nomdudossier</strong>, vous pouvez donc trouver cet ID vous même facilement en regardant l&#39;intérieur du <em>config.json</em> d&#39;un plugin.
Pour la version, nous avons ici mis la version du plugin, mais vous pouvez très bien la faire précéder d&#39;un outil de comparaison (cf. le semantic versionning donc les outils sont ^ / ~ / &gt;= / &lt;=). Comme ceci :</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"supported"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"eywek.shop"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&gt;=1.0.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Dans ce cas là, vous indiquez que votre thème supporte uniquement les versions du plugin &ldquo;Boutique&rdquo; au dessus et incluant la 1.0.0.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"supported"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"eywek.shop"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Dans ce cas là, vous indiquez que votre thème supporte uniquement les versions du plugin &ldquo;Boutique&rdquo; au dessus et incluant la 1.0.0 mais en dessous de la 2.0.0.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"supported"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"eywek.shop"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.0.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Dans ce cas là, vous indiquez que votre thème supporte uniquement les versions du plugin &ldquo;Boutique&rdquo; au dessus et incluant la 1.0.0 mais au dessous de la 1.1.0.</p>

<h2 id="utiliser-des-fichiers-css-js-ou-images-personnalis-es">Utiliser des fichiers CSS, JS ou images personnalisées</h2>

<p>Il est utile quand vous créez un thème de pouvoir utiliser des fichiers CSS/JS personnalisés ou même des images.
Pour cela, il vous suffit de créer un dossier <em>webroot</em> contenant les sous-dossiers :</p>

<ul>
<li><code class="prettyprint">css</code></li>
<li><code class="prettyprint">js</code></li>
<li><code class="prettyprint">img</code></li>
</ul>

<p>C&#39;est donc dans ces dossiers que vous glisserez vos fichiers.
Pour pouvoir les inclure facilement, il vous suffit de faire ceci dans vos fichiers <em>.ctp</em> :</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">css</span><span class="p">(</span><span class="s1">'NomDuDossierDuTheme.votrefichier.css'</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'NomDuDossierDuTheme.votrefichier.js'</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">image</span><span class="p">(</span><span class="s1">'votreimage.ext'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'alt'</span> <span class="o">=&gt;</span> <span class="s1">'Ce que je veux'</span><span class="p">))</span> <span class="cp">?&gt;</span>
</code></pre>

<blockquote>
<p>Vous pouvez avoir plus d&#39;informations <a href="http://book.cakephp.org/2.0/fr/core-libraries/helpers/html.html">ici</a>.</p>
</blockquote>

<h2 id="page-de-personnalisation">Page de personnalisation</h2>

<p>Votre thème peut proposer une page de personnalisation, qui permet à l&#39;administrateur de modifier certains aspects de votre thème, tels que la favicon, le logo, le style de navigation, etc.
Les modifications faites sur la page de personnalisation seront sauvegardées dans le fichier <code class="prettyprint">config.json</code>. Vous n&#39;avez pas besoin de modifier ce fichier pour créer votre page.</p>

<p>Il vous faut pour cela créer un fichier <code class="prettyprint">view.ctp</code> dans le dossier <code class="prettyprint">Config</code> du thème.
Comme d&#39;habitude, prenez pour exemple la page de personnalisation d&#39;un thème déjà existant. Copiez-collez le fichier pour être sûr d&#39;avoir la bonne structure.</p>

<p>Chaque champ de votre page sera sauvegardé si sa valeur est définie et valide.
Le nom d&#39;un champ correspondra à son entrée dans la configuration du thème c&#39;est-à-dire que:</p>
<pre class="highlight html"><code><span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"monOption"</span> <span class="na">value=</span><span class="s">"&lt;?= $config['monOption']"</span><span class="nt">&gt;</span>
</code></pre>

<p>aura pour nom &#39;monOption&rsquo; et sera accessible dans toutes les pages de votre thème grâce à la variable <code class="prettyprint">$theme_config[&#39;monOption&#39;]</code>.
<aside class="alert alert-warning">Comme vous pouvez le voir, le nom de la variable est <code class="prettyprint">$config[&#39;monOption&#39;]</code> dans la page de personnalisation. Cette variable n&#39;existe que sur cette page, tout comme la variable <code class="prettyprint">$theme_config</code> n&#39;existe pas dans la personnalisation.</aside></p>

<p>Libre à vous de choisir les différents types de champs dont vous avez besoin dans la configuration du thème.</p>

<h3 id="uploader-un-logo">Uploader un logo</h3>

<p>Réferez-vous au thème Universal pour voir de quelle manière est uploadé le logo sur la page de personnalisation.
Insérez ce PHP au début de votre page:</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$form_input</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="nv">$Lang</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'THEME__UPLOAD_LOGO'</span><span class="p">));</span>

<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$config</span><span class="p">[</span><span class="s1">'logo'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$config</span><span class="p">[</span><span class="s1">'logo'</span><span class="p">])</span> <span class="p">{</span>
  <span class="nv">$form_input</span><span class="p">[</span><span class="s1">'img'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$config</span><span class="p">[</span><span class="s1">'logo'</span><span class="p">];</span>
  <span class="nv">$form_input</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'theme_logo.png'</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>

<p>Lorsque vous souhaitez afficher l&#39;élément permettant d&#39;envoyer le logo, utilisez:</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">element</span><span class="p">(</span><span class="s1">'form.input.upload.img'</span><span class="p">,</span> <span class="nv">$form_input</span><span class="p">)</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Vous pourrez trouver ci-dessous des exemples d&#39;options.</p>

<h3 id="champ-de-s-lection">Champ de sélection</h3>

<p>Voici un exemple d&#39;une option où plusieurs choix sont possibles:</p>
<pre class="highlight php"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label&gt;</span>Désactiver le Slider<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"slider_enabled"</span> <span class="na">class=</span><span class="s">"form-control"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"true"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$config</span><span class="p">[</span><span class="s1">'slider_enabled'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"true"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Oui<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"false"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$config</span><span class="p">[</span><span class="s1">'slider_enabled'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"false"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Non<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>

<h3 id="champ-choix-multiples">Champ à choix multiples</h3>
<pre class="highlight php"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label&gt;</span>Couleur de navigation<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;small&gt;</span>Couleur générale de la navigation<span class="nt">&lt;/small&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"nav-color"</span> <span class="na">class=</span><span class="s">"form-control"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#ba2222"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#ba2222"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Rouge<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#0f1bab"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#0f1bab"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Bleu foncé<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#129cc5"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#129cc5"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Bleu cyan<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#c54c12"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#c54c12"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Orange<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#c5b712"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#c5b712"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Jaune<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#9112c5"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#9112c5"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Violet<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#3ec512"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#3ec512"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Vert clair<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"#175f00"</span><span class="cp">&lt;?=</span> <span class="p">(</span><span class="nv">$theme_config</span><span class="p">[</span><span class="s1">'nav-color'</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"#175f00"</span><span class="p">)</span> <span class="o">?</span> <span class="s1">' selected'</span> <span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="nt">&gt;</span>Vert foncé<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>

<h3 id="champ-html">Champ HTML</h3>

<p>Pour afficher un module d&#39;édition HTML, vous devez inclure le code suivant en haut de votre page, permettant de charger le plugin JavaScript TinyMCE:</p>
<pre class="highlight php"><code><span class="cp">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">script</span><span class="p">(</span><span class="s1">'admin/tinymce/tinymce.min.js'</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>

<p>Vous devez ensuite charger le plugin sur un élément donné.</p>
<pre class="highlight html"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label&gt;</span>HTML Supplémentaire de la sidebar<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;p&gt;</span>Ajoutez ici votre propre HTML à ajouter en bas de la sidebar.<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
        <span class="nx">tinymce</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
                <span class="na">selector</span><span class="p">:</span> <span class="s2">"#sidebar_code"</span><span class="p">,</span>
                <span class="na">height</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="na">width</span> <span class="p">:</span> <span class="s1">'100%'</span><span class="p">,</span>
                <span class="na">language</span> <span class="p">:</span> <span class="s1">'fr_FR'</span><span class="p">,</span>
                <span class="na">plugins</span><span class="p">:</span> <span class="s2">"textcolor code image link"</span><span class="p">,</span>
                <span class="na">toolbar</span><span class="p">:</span> <span class="s2">"fontselect bold italic link image forecolor alignleft aligncenter alignright alignjustify cut copy paste bullist numlist code"</span>
         <span class="p">});</span>
        <span class="nt">&lt;/script&gt;</span>
        <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"sidebar_code"</span> <span class="na">name=</span><span class="s">"sidebar_code"</span> <span class="na">cols=</span><span class="s">"30"</span> <span class="na">rows=</span><span class="s">"10"</span><span class="nt">&gt;</span><span class="cp">&lt;?= $config['sidebar_code']; ?&gt;</span><span class="nt">&lt;/textarea&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
